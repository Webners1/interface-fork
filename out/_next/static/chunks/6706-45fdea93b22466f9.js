"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6706],{3382:function(e,t,a){var r=a(44554),s=a(76866),n=(a(67294),a(85893));t.Z=e=>{let{children:t,className:a}=e;return(0,s.Z)()?(0,n.jsxs)("div",{className:(0,r.AK)(a,"relative w-full max-w-2xl"),children:[(0,n.jsx)("div",{className:(0,r.AK)("from-pink/5 to-blue/5 fixed inset-0 bg-gradient-radial z-0 pointer-events-none")}),(0,n.jsx)("div",{className:"relative filter z-10",children:t})]}):(0,n.jsx)(n.Fragment,{children:t})}},26587:function(e,t,a){a(67294);var r=a(85893);function s(e){return(e=parseFloat(e))<100&&e>=90?"#ff3a31":e<90&&e>=80?"#f85815":e<80&&e>=70?"#ed7000":e<70&&e>=60?"#de8400":e<60&&e>=50?"#ce9700":e<50&&e>=40?"#bba700":e<40&&e>=30?"#a6b500":e<30&&e>=20?"#8fc21b":e<20&&e>=10?"#73ce42":e<10&&e>=0||0==e?"#4ed864":"#ff3a31"}function n(e){return(e=parseFloat(e))<10&&e>=0?"#ff3a31":e<20&&e>=10?"#f85815":e<30&&e>=20?"#ed7000":e<40&&e>=30?"#de8400":e<50&&e>=40?"#ce9700":e<60&&e>=50?"#bba700":e<70&&e>=60?"#a6b500":e<80&&e>=70?"#8fc21b":e<90&&e>=80?"#73ce42":e<100&&e>=90||e>=100?"#4ed864":"#ff3a31"}t.ZP=e=>{let{percent:t,desc:a=!0}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("span",{style:{display:"block",height:"0.5rem",width:"0.5rem",borderRadius:"9999px",marginLeft:"0.5rem",background:"".concat(a?s(t):n(t))}})})}},26706:function(e,t,a){a.d(t,{Ho:function(){return d},jz:function(){return w},ie:function(){return K},JA:function(){return te},wu:function(){return I},_2:function(){return ae},PG:function(){return se},zE:function(){return ie},vu:function(){return ce},NF:function(){return ve},Mp:function(){return c},Hc:function(){return ge},EG:function(){return pe},rq:function(){return we},W9:function(){return M},JM:function(){return Ne},Kk:function(){return he},Ue:function(){return be}});var r=a(14744),s=a(95203),n=a(1420),i=a(11163),l=a(67294),o=a(85893);let c;!function(e){e.DEPOSIT="deposit",e.WITHDRAW="withdraw",e.BORROW="borrow",e.REPAY="repay"}(c||(c={}));const d=()=>{const{i18n:e}=(0,r.mV)(),t=(0,i.useRouter)(),{0:a,1:d}=(0,l.useState)(t.query.view||c.REPAY);return(0,o.jsx)(n.yz,{children:(0,o.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,o.jsxs)(s.Z,{size:"sm",value:a,onChange:d,variant:"filled",className:"flex flex-grow bg-dark-800",children:[(0,o.jsx)(s.Z.Button,{value:c.REPAY,children:e._(e._("Repay"))}),(0,o.jsx)(s.Z.Button,{value:c.WITHDRAW,children:e._(e._("Withdraw"))})]}),a===c.REPAY&&(0,o.jsx)(ce,{}),a===c.WITHDRAW&&(0,o.jsx)(we,{})]})})};var u=a(2593),x=a(56727);var m=l.forwardRef((function(e,t){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),l.createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"}))})),h=a(32601),v=a(31518),g=a(70867),p=a(54962),f=a(56785),j=a(42388);const w=e=>{let{market:t}=e;const[,,,,a]=(0,j.ZP)(),r=(0,l.useCallback)((async e=>(e.updateExchangeRate(!1,u.O$.from(0),u.O$.from(0)),h.ag._(h.ag._("Update Price")))),[]),s=(0,l.useCallback)((async e=>(e.add(g.yJ,"0x00"),h.ag._(h.ag._("Accrue")))),[]),n=(0,l.useMemo)((()=>{const e=(0,v.gW)(v.QA.subtract(t.exchangeRate,t.oracleExchangeRate),v.QA.BigInt(0));return v.QA.greaterThan(t.exchangeRate,v.xE)?new v.gG(e,t.exchangeRate).toFixed(2):"-"}),[t]);return(0,o.jsxs)(x.v2,{as:"div",children:[(0,o.jsx)("div",{children:(0,o.jsx)(x.v2.Button,{children:(0,o.jsx)("div",{className:"flex items-center justify-center p-2 rounded-full cursor-pointer hover:text-white",children:(0,o.jsx)(m,{width:18,height:18})})})}),(0,o.jsx)(x.uT,{as:l.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,o.jsxs)(x.v2.Items,{static:!0,className:"shadow-md absolute max-h-[240px] overflow-auto border mt-2 divide-y rounded focus:outline-none border-dark-700 bg-dark-800 divide-dark-700",children:[(0,o.jsx)(x.v2.Item,{onClick:e=>{e.preventDefault(),a(t,s)},children:(0,o.jsxs)(f.Z,{variant:"sm",weight:700,className:"flex px-3 py-2 cursor-pointer hover:bg-dark-900/40",children:[h.ag._(h.ag._("Accrue")),(0,o.jsx)(p.Z,{text:(0,o.jsx)("div",{className:"flex flex-col gap-2",children:(0,o.jsx)(f.Z,{variant:"xs",className:"text-white",children:h.ag._(h.ag._("Accrue the interest rate on borrowed tokens and update the interest rate"))})})})]})}),(0,o.jsx)(x.v2.Item,{onClick:e=>{e.preventDefault(),a(t,r)},children:(0,o.jsxs)(f.Z,{variant:"sm",weight:700,className:"flex px-3 py-2 cursor-pointer hover:bg-dark-900/40",children:[h.ag._(h.ag._("Update Price")),(0,o.jsx)(p.Z,{text:(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-white",children:h.ag._(h.ag._("Update the oracle exchange rate"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"italic",children:h.ag._(h.ag._("Current deviation: {priceChange}%",{priceChange:n}))})]})})]})})]})})]})};var y=a(71862),b=a(59499);class N{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;(0,b.Z)(this,"active",!1),(0,b.Z)(this,"message",""),(0,b.Z)(this,"breaking",!1),(0,b.Z)(this,"or",void 0),this.active=e,this.message=t,this.breaking=a,this.or=r}}class A extends Array{_add(e){e.active?this.push(e):e.or&&this._add(e.or)}add(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return this._add(new N(e,t,a,r)),this}addWarning(e,t,a){return this._add(new N(e,t,!1,a)),this}addError(e,t,a){return this._add(new N(e,t,!0,a)),this}get broken(){return this.some((e=>e.breaking))}}var _=a(49932),k=a(44554),Z=a(53389),S=a(15423),C=a(12614);var B=a(45486);a(94492);var P=a(573);var O=a(41626),R=a(70028),T=a(54684),E=a(56388);const W=(0,l.createContext)(void 0),I=e=>{let{market:t,children:a}=e;return(0,o.jsx)(W.Provider,{value:(0,l.useMemo)((()=>({market:t})),[t]),children:a})},M=()=>{const e=(0,l.useContext)(W);if(!e)throw new Error("Hook can only be used inside Kashi Market Context");return e};var Q=a(26587);const F=e=>{let{setCollateralAmount:t,setBorrowAmount:a}=e;const{i18n:s}=(0,r.mV)(),{market:n}=M(),i=v.ih.fromRawAmount((0,k.Bv)(n.collateral.token),n.userCollateralAmount),l=v.ih.fromRawAmount((0,k.Bv)(n.asset.token),n.currentUserBorrowAmount);return(0,o.jsxs)("div",{className:"grid grid-cols-3 px-3",children:[(0,o.jsxs)("div",{className:"flex flex-col items-baseline",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:s._(s._("Collateralized"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:(0,k.AK)(t?"cursor-pointer":"","text-high-emphesis"),onClick:()=>t&&t(i.toExact()),children:[i.toSignificant(6),(0,o.jsxs)(f.Z,{weight:700,variant:"xs",className:"text-secondary",component:"span",children:[" ",n.collateral.token.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:s._(s._("Borrowed"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:(0,k.AK)(a?"cursor-pointer":"","text-high-emphesis"),onClick:()=>a&&a(l.toExact()),children:[l.toSignificant(6),(0,o.jsxs)(f.Z,{weight:700,variant:"xs",className:"text-secondary",component:"span",children:[" ",n.asset.token.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col items-end",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-right text-secondary",children:s._(s._("Health"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:"flex items-center text-high-emphesis",children:[new v.gG(n.health,1e18).toSignificant(6),"%",(0,o.jsx)("div",{className:"-ml-1",children:(0,o.jsx)(p.Z,{icon:(0,o.jsx)(Q.ZP,{percent:new v.gG(n.health,1e18).toSignificant(6)}),text:(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-white",children:s._(s._("Health of your position defined as your current borrowed amount divided by the max borrow amount given current collateral."))}),(0,o.jsx)(f.Z,{variant:"xs",className:"italic",children:s._(s._("100% means you are at max borrow"))})]})})})]})]})]})};var D=a(92088),z=a(16339),H=a(37643);var U=a(74703),q=a(68411);var L=a(81889);const K=e=>{let{setLentAmount:t}=e;const{i18n:a}=(0,r.mV)(),{market:s}=M(),n=v.ih.fromRawAmount(s.asset.token,s.currentUserAssetAmount);return(0,o.jsxs)("div",{className:"grid grid-cols-3 px-3",children:[(0,o.jsxs)("div",{className:"flex flex-col items-baseline",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:a._(a._("Deposited"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:(0,k.AK)(t?"cursor-pointer":"","text-high-emphesis"),onClick:()=>t&&t(n.toExact()),children:[n.toSignificant(6),(0,o.jsxs)(f.Z,{weight:700,variant:"xs",className:"text-secondary",component:"span",children:[" ",s.asset.token.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:a._(a._("Borrowed"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:"text-high-emphesis",children:[new v.gG(s.utilization,1e18).toSignificant(6),"%"]})]}),(0,o.jsxs)("div",{className:"flex flex-col items-end",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary text-right",children:a._(a._("Supply APR"))}),(0,o.jsxs)(f.Z,{weight:700,variant:"sm",className:"text-high-emphesis flex items-center",children:[new v.gG(s.supplyAPR,1e18).toSignificant(6),"%"]})]})]})};var V=a(61782);var Y=l.forwardRef((function(e,t){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),l.createElement("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"}))})),$=a(70518),G=a(84329);const X=e=>{let{lentAmount:t,view:a}=e;const{chainId:s}=(0,C.aQ)(),{i18n:n}=(0,r.mV)(),{market:i}=M(),l=(0,G.Mh)({chainId:s,variables:{where:{token:i.collateral.token.address.toLowerCase()}}}),d=null===l||void 0===l?void 0:l[0],u=v.ih.fromRawAmount((0,k.Bv)(i.asset.token),i.currentUserAssetAmount),x=t&&v.ih.fromRawAmount(t.currency,i.currentUserAssetAmount)[a===c.DEPOSIT?"add":"subtract"](t);return(0,o.jsxs)("div",{className:"flex flex-col divide-y divide-dark-850",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-1 pb-2",children:[(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:n._(n._("Supply APR"))}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[new v.gG(i.supplyAPR,1e18).toFixed(6),"%"]})]}),v.QA.greaterThan(i.utilization,v.xE)&&(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:n._(n._("Health"))}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[new v.gG(i.marketHealth,1e18).toFixed(6),"%"]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"flex items-center",children:[n._(n._("BentoBox strategy")),(0,o.jsx)(p.Z,{text:(0,o.jsx)("div",{children:(0,o.jsx)(f.Z,{variant:"xs",children:"BentoBox strategies can create yield for your liquidity while it is not lent out."})})})]}),d?(0,o.jsx)($.ZP,{text:(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:n._(n._("Strategy APY"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(d.apy)})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:n._(n._("Current Percentage"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(d.utilization)})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:n._(n._("Target Percentage"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(d.targetPercentage)})]})]}),children:(0,o.jsxs)(f.Z,{variant:"xs",className:(0,k.AK)(d?"text-blue":"","text-right"),children:[d?n._(n._("Active")):n._(n._("None"))," "]})}):(0,o.jsxs)(f.Z,{variant:"xs",className:(0,k.AK)(d?"text-blue":"","text-right"),children:[d?n._(n._("Active")):n._(n._("None"))," "]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-1 pt-2",children:[(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:n._(n._("Total lent"))}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right text-secondary",children:[null===u||void 0===u?void 0:u.toSignificant(6)," ",null===u||void 0===u?void 0:u.currency.symbol]}),(0,o.jsx)(Y,{width:14,className:"text-secondary"}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[null===x||void 0===x?void 0:x.toSignificant(6)," ",null===u||void 0===u?void 0:u.currency.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:n._(n._("Oracle"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right text-secondary",children:i.oracle.name})]})]})]})},J=e=>{let{lentAmount:t,view:a}=e;const{i18n:s}=(0,r.mV)(),{market:n}=M(),i=v.ih.fromRawAmount((0,k.Bv)(n.asset.token),n.currentUserAssetAmount),d=t&&v.ih.fromRawAmount(t.currency,n.currentUserAssetAmount)[a===c.DEPOSIT?"add":"subtract"](t);return(0,o.jsx)(x.pJ,{as:"div",children:e=>{let{open:r}=e;return(0,o.jsxs)("div",{className:(0,k.AK)(r?"bg-dark-900":"","shadow-inner flex flex-col gap-2 py-2 rounded px-2 border border-dark-700 transition hover:border-dark-700"),children:[(0,o.jsxs)("div",{className:"flex items-center justify-between gap-2 pl-1",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)(f.Z,{variant:"xs",weight:700,children:s._(s._("Deposited"))}),(0,o.jsxs)("div",{className:"flex justify-between gap-1",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right text-secondary",children:[null===i||void 0===i?void 0:i.toSignificant(6)," ",null===i||void 0===i?void 0:i.currency.symbol]}),(0,o.jsx)(Y,{width:14,className:"text-secondary"}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[null===d||void 0===d?void 0:d.toSignificant(6)," ",null===i||void 0===i?void 0:i.currency.symbol]})]})]}),(0,o.jsx)(x.pJ.Button,{as:l.Fragment,children:(0,o.jsx)("div",{className:"flex items-center justify-end flex-grow p-1 rounded cursor-pointer",children:(0,o.jsx)(V.Z,{width:20,className:(0,k.AK)(r?"transform rotate-180":"","transition hover:text-white")})})})]}),(0,o.jsx)(x.uT,{show:r,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",unmount:!1,children:(0,o.jsx)(x.pJ.Panel,{static:!0,className:"px-1 pt-2",children:(0,o.jsx)(X,{lentAmount:t,view:a})})})]})}})};const ee=e=>{let{trade:t,priceImpact:a,collateralAmount:s,borrowAmount:n,multiplier:i,view:l}=e;const{chainId:d}=(0,C.aQ)(),{i18n:u}=(0,r.mV)(),{market:x}=M(),m=(0,G.Mh)({chainId:d,variables:{where:{token:x.collateral.token.address.toLowerCase()}}}),h=null===m||void 0===m?void 0:m[0],g=(0,z.C)(H.tE),j=v.ih.fromRawAmount((0,k.Bv)(x.asset.token),x.currentUserBorrowAmount),w=v.ih.fromRawAmount((0,k.Bv)(x.collateral.token),x.userCollateralAmount),y=l===c.BORROW&&i&&t?t.minimumAmountOut(g):v.ih.fromRawAmount((0,k.Bv)(x.collateral.token),v.QA.BigInt(0)),b=s?w[l===c.BORROW?"add":"subtract"](s.add(y)):v.ih.fromRawAmount(x.collateral.token,x.userCollateralAmount),N=n?j[l===c.BORROW?"add":"subtract"](n):v.ih.fromRawAmount(x.asset.token,x.currentUserBorrowAmount);return(0,o.jsxs)("div",{className:"flex flex-col divide-y divide-dark-850",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-1 pb-2",children:[(s||n)&&(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Position Health"))}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right text-secondary",children:[new v.gG(x.health,1e18).toSignificant(6),"%"]}),(0,o.jsx)(Y,{width:14,className:"text-secondary"}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[new v.gG(x.simulatedHealth(null===N||void 0===N?void 0:N.quotient,null===b||void 0===b?void 0:b.quotient),1e18).toSignificant(6),"%"]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("APR (annualized)"))}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[new v.gG(x.currentInterestPerYear,1e18).toFixed(2),"%"]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Loan to Value (LTV)"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:"75%"})]}),a&&(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Price Impact"))}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[a.toSignificant(2),"%"]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"flex items-center",children:[u._(u._("BentoBox strategy")),(0,o.jsx)(p.Z,{text:(0,o.jsx)("div",{children:(0,o.jsx)(f.Z,{variant:"xs",children:"BentoBox strategies can create yield for your liquidity while it is not lent out."})})})]}),h?(0,o.jsx)($.ZP,{text:(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Strategy APY"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(h.apy)})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Current Percentage"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(h.utilization)})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",children:u._(u._("Target Percentage"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right",children:(0,k.T3)(h.targetPercentage)})]})]}),children:(0,o.jsxs)(f.Z,{variant:"xs",className:(0,k.AK)(h?"text-blue":"","text-right"),children:[h?u._(u._("Active")):u._(u._("None"))," "]})}):(0,o.jsxs)(f.Z,{variant:"xs",className:(0,k.AK)(h?"text-blue":"","text-right"),children:[h?u._(u._("Active")):u._(u._("None"))," "]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-1 pt-2",children:[s&&(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:u._(u._("Total collateral"))}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right text-secondary",children:[w.toSignificant(6)," ",x.collateral.token.symbol]}),(0,o.jsx)(Y,{width:14,className:"text-secondary"}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[null===b||void 0===b?void 0:b.toSignificant(6)," ",x.collateral.token.symbol]})]})]}),n&&(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:u._(u._("Total borrowed"))}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right text-secondary",children:[null===j||void 0===j?void 0:j.toSignificant(6)," ",x.asset.token.symbol]}),(0,o.jsx)(Y,{width:14,className:"text-secondary"}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-right",children:[null===N||void 0===N?void 0:N.toSignificant(6)," ",x.asset.token.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:u._(u._("Oracle"))}),(0,o.jsx)(f.Z,{variant:"xs",className:"text-right text-secondary",children:x.oracle.name})]})]})]})},te=e=>{let{priceImpact:t,collateralAmount:a,borrowAmount:s,multiplier:n,view:i,trade:d}=e;const{i18n:u}=(0,r.mV)(),{0:m,1:h}=(0,l.useState)(!1),v=Ne({invert:m,borrowAmount:s,collateralAmount:a,trade:d,reduce:i===c.REPAY});return(0,o.jsx)(x.pJ,{as:"div",children:e=>{let{open:r}=e;return(0,o.jsxs)("div",{className:(0,k.AK)(r?"bg-dark-900":"","shadow-inner flex flex-col gap-2 py-2 rounded px-2 border border-dark-700 transition hover:border-dark-700"),children:[(0,o.jsxs)("div",{className:"flex items-center justify-between gap-2 pl-1",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsxs)(f.Z,{variant:"xs",weight:700,className:"flex gap-2 -ml-1",children:[(0,o.jsx)(p.Z,{text:(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-white",children:u._(u._("When the value of your collateral becomes less than the asset you borrow, your position gets liquidated."))}),(0,o.jsx)(f.Z,{variant:"xs",className:"italic",children:u._(u._("When a non-leveraged positions gets liquidated, you lose the collateral but you can keep the borrowed assets"))})]})}),i===c.BORROW?u._(u._("Liquidation Price")):u._(u._("New Liquidation Price"))]}),v&&(0,o.jsx)(f.Z,{onClick:()=>h((e=>!e)),variant:"xs",weight:700,className:"py-1 rounded rounded-full cursor-pointer hover:text-high-emphesis",children:v})]}),(0,o.jsx)(x.pJ.Button,{as:l.Fragment,children:(0,o.jsx)("div",{className:"flex items-center justify-end flex-grow p-1 rounded cursor-pointer",children:(0,o.jsx)(V.Z,{width:20,className:(0,k.AK)(r?"transform rotate-180":"","transition hover:text-white")})})})]}),(0,o.jsx)(x.uT,{show:r,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",unmount:!1,children:(0,o.jsx)(x.pJ.Panel,{static:!0,className:"px-1 pt-2",children:(0,o.jsx)(ee,{trade:d,priceImpact:t,collateralAmount:a,multiplier:n,borrowAmount:s,view:i})})})]})}})},ae=e=>{let{closePosition:t,repayFromWallet:a,removeToWallet:s,repayAmount:n,removeAmount:i,trade:c,view:d,repayMax:u,removeMax:x,nextMaxRemoveCollateral:m,nextMinCollateralMinimum:h}=e;const{account:g}=(0,C.aQ)(),{i18n:p}=(0,r.mV)(),{market:j}=M(),w=(0,k.Bv)(j.asset.token),{chainId:b}=((0,k.Bv)(j.collateral.token),(0,C.aQ)()),B=(0,S.C)(null!==g&&void 0!==g?g:void 0,w,a),{0:P,1:O}=(0,l.useState)(),{0:R,1:T}=(0,l.useState)(!1),E=(0,Z.rO)(),W=b?v.MO[b]:void 0,{0:I,1:Q}=(0,l.useState)(!1),F=i?v.ih.fromRawAmount(i.currency,j.totalCollateralAmount):void 0,D=g?t||null!==n&&void 0!==n&&n.greaterThan(v.xE)||null!==i&&void 0!==i&&i.greaterThan(v.xE)?B?null!==n&&void 0!==n&&n.greaterThan(B)?p._(p._("Insufficient balance")):F&&i&&i.greaterThan(F)?p._(p._("Not enough {0} available",{0:i.currency.symbol})):null!==i&&void 0!==i&&i.greaterThan(j.userCollateralAmount)?p._(p._("Withdraw too large")):null!==n&&void 0!==n&&n.greaterThan(j.currentUserBorrowAmount)?"Repay larger than debt":"":p._(p._("Loading balance")):p._(p._("Enter an amount")):p._(p._("Connect Wallet")),z=D||(t?p._(p._("Close Position")):null!==i&&void 0!==i&&i.greaterThan(v.xE)&&null!==n&&void 0!==n&&n.greaterThan(v.xE)?p._(p._("Repay and Remove")):null!==i&&void 0!==i&&i.greaterThan(v.xE)?p._(p._("Remove Collateral")):null!==n&&void 0!==n&&n.greaterThan(v.xE)?p._(p._("Repay Debt")):""),H=new A;return H.addError(Boolean(b&&w.wrapped.address===v.df[b]&&a&&u),"You cannot MAX repay ".concat(w.symbol," directly from your wallet. Please deposit your ").concat(w.symbol," into the BentoBox first, then repay. Because your debt is slowly accruing interest we can't predict how much it will be once your transaction gets mined.")).addError(R,p._(p._("Something went wrong during signing of the approval. This is expected for hardware wallets, such as Trezor and Ledger. Click 'Approve BentoBox' again for approving using the fallback method"))).addError(Boolean(n&&v.QA.greaterThan(n.quotient,j.currentUserBorrowAmount)),"You can't repay more than you owe. To fully repay, please click the 'max' button.",new N(Boolean(B&&n&&B.lessThan(n)),"Please make sure your ".concat(a?"wallet":"BentoBox"," balance is sufficient to repay and then try again."),!0)).addError(Boolean(i&&(null===i||void 0===i?void 0:i.greaterThan((0,v.gW)(v.QA.subtract(j.userCollateralAmount,h),v.xE)))),"Removing this much collateral would put you into insolvency.",new N(Boolean(i&&(null===i||void 0===i?void 0:i.greaterThan(m))),"Removing this much collateral would put you very close to insolvency.")),(0,o.jsxs)(o.Fragment,{children:[H.reduce(((e,t,a)=>(t&&e.push((0,o.jsx)(f.Z,{variant:"sm",className:"p-4 text-center border rounded border-yellow/40 text-yellow",children:t.message},a)),e)),[]),(0,o.jsx)(_.Z,{spendFromWallet:a,inputAmounts:t?[]:[n],tokenApproveOn:null===E||void 0===E?void 0:E.address,masterContractAddress:W,withPermit:!0,permit:P,onPermit:O,onPermitError:()=>T(!0),children:e=>{let{approved:t,loading:a}=e;const r=!!D||!t||a||H.some((e=>e.breaking));return(0,o.jsx)(y.ZP,{loading:a,color:"gradient",disabled:r,onClick:()=>Q(!0),className:"rounded-2xl md:rounded",children:z})}}),(0,o.jsx)(ie,{open:I,onDismiss:()=>Q(!1),repayFromWallet:a,repayAmount:n,removeToWallet:s,removeAmount:i,closePosition:t,trade:c,view:d,removeMax:x,repayMax:u,permit:P})]})};var re=a(64343);const se=e=>{let{enabled:t,onSwitch:a,setRepayAmount:s,setRemoveAmount:n}=e;const{i18n:i}=(0,r.mV)(),{market:c}=M(),d=v.ih.fromRawAmount((0,k.Bv)(c.asset.token),c.currentUserBorrowAmount),u=v.ih.fromRawAmount((0,k.Bv)(c.collateral.token),c.userCollateralAmount);return(0,o.jsx)(x.pJ,{as:"div",children:e=>{let{open:r}=e;return(0,o.jsxs)("div",{className:(0,k.AK)(r?"bg-dark-900":"","shadow-inner flex flex-col gap-2 py-2 rounded px-2 border border-dark-700 transition hover:border-dark-700"),children:[(0,o.jsxs)("div",{className:"flex justify-between gap-2 items-center pl-1",children:[(0,o.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,o.jsxs)(f.Z,{variant:"xs",weight:700,className:"flex -ml-1 gap-2",children:[(0,o.jsx)(p.Z,{text:(0,o.jsx)("div",{className:"flex flex-col gap-2",children:(0,o.jsx)(f.Z,{variant:"xs",className:"text-white",children:i._(i._("Close your position by swapping your collateral for the borrowed asset"))})})}),i._(i._("Close Position"))]}),(0,o.jsx)(P.Z,{size:"sm",id:"toggle-expert-mode-button",checked:t,onChange:a,checkedIcon:(0,o.jsx)(re.Z,{className:"text-dark-700"}),uncheckedIcon:(0,o.jsx)(B.Z,{}),color:"gradient"})]}),(0,o.jsx)(x.pJ.Button,{as:l.Fragment,children:(0,o.jsx)("div",{className:"flex flex-grow items-center justify-end p-1 cursor-pointer rounded",children:(0,o.jsx)(V.Z,{width:20,className:(0,k.AK)(r?"transform rotate-180":"","transition hover:text-white")})})})]}),(0,o.jsx)(x.uT,{show:r,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",unmount:!1,children:(0,o.jsx)(x.pJ.Panel,{static:!0,className:"px-2 pb-2 pt-1",children:(0,o.jsxs)("div",{className:"rounded flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex gap-2 items-center cursor-pointer",onClick:()=>n(null===u||void 0===u?void 0:u.toExact()),children:[(0,o.jsx)(O.X,{currency:c.collateral.token,size:20}),(0,o.jsxs)(f.Z,{variant:"sm",weight:700,children:["Collateral ",u.toSignificant(6)," ",u.currency.symbol]})]}),(0,o.jsxs)("div",{className:"flex gap-2 items-center cursor-pointer",onClick:()=>s(null===d||void 0===d?void 0:d.toExact()),children:[(0,o.jsx)(O.X,{currency:c.asset.token,size:20}),(0,o.jsxs)(f.Z,{variant:"sm",weight:700,children:["Borrowed ",d.toSignificant(6)," ",d.currency.symbol]})]})]})})})]})}})};var ne=a(627);const ie=e=>{var t,a;let{trade:s,repayFromWallet:n,removeToWallet:i,repayAmount:c,removeAmount:d,closePosition:u,open:x,onDismiss:m,view:h,removeMax:g,repayMax:p}=e;const{i18n:j}=(0,r.mV)(),{market:w}=M(),{0:b,1:N}=(0,l.useState)(),{0:A,1:_}=(0,l.useState)(!1),Z=he(),S=v.ih.fromRawAmount((0,k.Bv)(w.asset.token),w.currentUserBorrowAmount),C=v.ih.fromRawAmount((0,k.Bv)(w.collateral.token),w.userCollateralAmount),B=(0,l.useCallback)((async()=>{_(!0);try{const e=await Z({trade:s,repayFromWallet:n,repayAmount:c,closePosition:u,removeToWallet:i,removeAmount:d,removeMax:g,repayMax:p});null!==e&&void 0!==e&&e.hash&&N(e.hash)}finally{_(!1)}}),[u,Z,d,g,i,c,n,p,s]),P=(0,k.oX)(null===s||void 0===s?void 0:s.priceImpact),E=(0,ne.LO)();return(0,o.jsx)(R.S.Controlled,{isOpen:x,onDismiss:m,maxWidth:"md",afterLeave:()=>N(void 0),children:b?(0,o.jsx)(T.Z,{header:j._(j._("Success!")),subheader:j._(j._("Success! Repay Submitted")),txHash:b,onDismiss:m}):(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)(R.S.Header,{header:u?j._(j._("Close Position")):j._(j._("Confirm Repay")),onClose:m}),u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{variant:"sm",children:j._(j._("You will be closing this position by swapping your collateral for your borrowed debt. Any collateral remainder will be sent to your {0}",{0:i?"wallet":"BentoBox"}))}),(0,o.jsxs)(R.S.BorderedContent,{className:"flex flex-col gap-4 bg-dark-1000/40 !border-dark-700",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:j._(j._("Collateral that will be swapped"))}),(0,o.jsxs)("div",{className:"inline-flex gap-2",children:[(0,o.jsx)(O.X,{currency:w.collateral.token,size:20}),(0,o.jsxs)(f.Z,{weight:700,component:"span",className:"text-high-emphesis",children:[null===s||void 0===s||null===(t=s.inputAmount)||void 0===t?void 0:t.toSignificant(6),(0,o.jsxs)(f.Z,{weight:700,className:"text-low-emphesis",component:"span",children:[" ","/ ",C.toSignificant(6)," ",null===s||void 0===s?void 0:s.inputAmount.currency.symbol]})," "]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:j._(j._("To repay borrowed tokens"))}),(0,o.jsxs)("div",{className:"inline-flex gap-2",children:[(0,o.jsx)(O.X,{currency:w.asset.token,size:20}),(0,o.jsxs)(f.Z,{weight:700,component:"span",className:"text-high-emphesis",children:[null===S||void 0===S?void 0:S.toSignificant(6)," ",(0,o.jsx)(f.Z,{weight:700,className:"text-low-emphesis",component:"span",children:S.currency.symbol})]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:j._(j._("Price Impact"))}),(0,o.jsxs)(f.Z,{variant:"xs",className:"text-high-emphesis",children:[null===s||void 0===s||null===(a=s.priceImpact)||void 0===a?void 0:a.toFixed(2),"%"]})]})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{variant:"sm",children:j._(j._("You will be reducing this position by"))}),(0,o.jsxs)(R.S.BorderedContent,{className:"flex flex-col gap-4 bg-dark-1000/40 !border-dark-700",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:j._(j._("And removing"))}),(0,o.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,o.jsx)(O.X,{currency:w.collateral.token,size:20}),(0,o.jsxs)("b",{children:[null!==d&&void 0!==d&&d.greaterThan(0)?null===d||void 0===d?void 0:d.toSignificant(6):"0"," ",null===d||void 0===d?void 0:d.currency.symbol]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:j._(j._("Repaying"))}),(0,o.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,o.jsx)(O.X,{currency:w.asset.token,size:20}),(0,o.jsxs)("b",{children:[null!==c&&void 0!==c&&c.greaterThan(0)?null===c||void 0===c?void 0:c.toSignificant(6):"0"," ",null===c||void 0===c?void 0:c.currency.symbol]})]})]})]})]}),(0,o.jsx)(te,{view:h,collateralAmount:u?C:d,borrowAmount:u?S:c}),(0,o.jsx)(y.ZP,{loading:A,color:"gradient",disabled:A||P>3&&!E&&u,onClick:B,children:u?P>3&&!E?j._(j._("Price Impact Too High")):P>2?j._(j._("Close Position Anyway")):j._(j._("Close Position")):j._(j._("Confirm Repay"))})]})})};function le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?le(Object(a),!0).forEach((function(t){(0,b.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):le(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const ce=()=>{var e;const{i18n:t}=(0,r.mV)(),{market:a}=M(),{0:s,1:n}=(0,l.useState)(!1),{0:i,1:d}=(0,l.useState)(!0),{0:u,1:x}=(0,l.useState)(!0),{0:m,1:h}=(0,l.useState)(),{0:g,1:p}=(0,l.useState)(),{0:j,1:w}=(0,l.useState)(!1),{0:y,1:b}=(0,l.useState)(!1),N=(0,k.Bv)(a.asset.token),A=(0,k.Bv)(a.collateral.token),_=m?(0,k.eo)(m,N):void 0,Z=g?(0,k.eo)(g,A):void 0,S=v.ih.fromRawAmount((0,k.Bv)(a.collateral.token),a.userCollateralAmount),C=v.QA.subtract(a.currentUserBorrowAmount,_?null===_||void 0===_?void 0:_.quotient:v.QA.BigInt(0)),B=v.QA.divide(v.QA.multiply(C,a.oracleExchangeRate),v.QA.multiply(v.QA.BigInt(1e16),v.QA.BigInt(75))),P=v.QA.divide(v.QA.multiply(C,a.spotExchangeRate),v.QA.multiply(v.QA.BigInt(1e16),v.QA.BigInt(75))),O=v.QA.divide(v.QA.multiply(C,a.exchangeRate),v.QA.multiply(v.QA.BigInt(1e16),v.QA.BigInt(75))),R=(0,v.gW)(B,P,O),T=(0,v.gW)(v.QA.subtract(a.userCollateralAmount,v.QA.divide(v.QA.multiply(R,v.QA.BigInt(100)),v.QA.BigInt(75))),v.xE),W=v.ih.fromRawAmount(a.collateral.token,T),I=v.ih.fromRawAmount((0,k.Bv)(a.asset.token),a.currentUserBorrowAmount),Q=null!==(e=(0,E.k)((0,k.Bv)(a.collateral.token),v.ih.fromRawAmount((0,k.Bv)(a.asset.token),a.currentUserBorrowAmount),{maxHops:4}))&&void 0!==e?e:void 0,z=(0,l.useCallback)(((e,t)=>{p(e),w(t)}),[]),H=(0,l.useCallback)(((e,t)=>{h(e),b(t)}),[]);return(0,o.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,o.jsx)(F,{setBorrowAmount:p,setCollateralAmount:p}),(0,o.jsx)(D.Z,{disabled:s,error:null===_||void 0===_?void 0:_.greaterThan(a.currentUserBorrowAmount),header:e=>(0,o.jsx)(D.Z.Header,oe(oe({},e),{},{label:t._(t._("Repay")),hideSearchModal:!0})),walletToggle:e=>(0,o.jsx)(D.Z.Switch,oe(oe({id:"switch-classic-withdraw-from-0}"},e),{},{label:t._(t._("Repay from")),onChange:()=>d((e=>!e))})),spendFromWallet:i,currency:N,value:m,onChange:h,balancePanel:()=>(0,o.jsxs)(f.Z,{variant:"sm",className:"text-right text-secondary whitespace-nowrap",onClick:()=>H(I.toExact(),!0),children:["Max Repay: ",I.toSignificant(6)]})}),(0,o.jsx)("div",{className:"flex flex-col gap-2 -mt-1.5",children:(0,o.jsx)(D.Z,{disabled:s,error:null===Z||void 0===Z?void 0:Z.greaterThan(a.userCollateralAmount),header:e=>(0,o.jsx)(D.Z.Header,oe(oe({},e),{},{label:t._(t._("Remove")),hideSearchModal:!0})),walletToggle:e=>(0,o.jsx)(D.Z.Switch,oe(oe({},e),{},{id:"switch-classic-withdraw-from-0}",label:t._(t._("Receive in")),onChange:()=>x((e=>!e))})),spendFromWallet:u,currency:A,value:g,onChange:e=>z(e,!1),balancePanel:()=>(0,o.jsxs)(f.Z,{variant:"sm",className:"text-right text-secondary whitespace-nowrap",onClick:()=>z(W.toExact(),!0),children:["Max Withdraw: ",S.toSignificant(6)]})})}),(0,o.jsx)(se,{setRepayAmount:h,setRemoveAmount:p,enabled:s,onSwitch:()=>n((e=>!e))}),!s&&(0,o.jsx)(te,{priceImpact:s?null===Q||void 0===Q?void 0:Q.priceImpact:void 0,borrowAmount:_,collateralAmount:Z,view:c.REPAY}),(0,o.jsx)(ae,{trade:Q,closePosition:s,removeAmount:Z,repayAmount:_,repayFromWallet:i,removeToWallet:u,view:c.REPAY,repayMax:y,removeMax:j,nextMinCollateralMinimum:R,nextMaxRemoveCollateral:T})]})};var de=a(84243),ue=a(16441),xe=a(9279),me=a(69807);const he=()=>{const{i18n:e}=(0,r.mV)(),{account:t,library:a,chainId:s}=(0,C.aQ)(),n=s&&v.MO[s],i=(0,q.h7)(),o=(0,z.C)(H.tE),{market:c}=M();return(0,l.useCallback)((async r=>{let{trade:l,repayAmount:d,removeAmount:x,removeMax:m,repayMax:h,removeToWallet:g,repayFromWallet:p,closePosition:f}=r;if(!t||!a||!s||!n)return void console.error("Dependencies unavailable");const j=new U.Z(c,t,a,s);if(f&&l){const a=v.ih.fromRawAmount(c.asset.token,c.userBorrowPart),r=l.maximumAmountIn(o),n=l.route.path.map((e=>e.address))||[];j.removeCollateral(u.O$.from(c.userCollateralShare.toString()),!0),j.bentoTransferCollateral(u.O$.from(c.userCollateralShare.toString()),v.XX[s||1]),j.repayShare(u.O$.from(c.userBorrowPart.toString())),j.action(v.XX[s||1],k.xE,(0,ue.hexConcat)([(0,ue.hexlify)("0x3087d742"),de.$.encode(["address","address","uint256","address","address","address","uint256"],[c.collateral.token.address,c.asset.token.address,r.quotient.toString(),n.length>2?n[1]:xe.d,n.length>3?n[2]:xe.d,t,u.O$.from(c.userCollateralShare.toString())])]),!0,!1,1),j.repayPart(u.O$.from(c.userBorrowPart.toString()),!0),g&&j.bentoWithdrawCollateral(k.xE,u.O$.from(-1));const d=await j.cook();if(d.success)return i(d.tx,{summary:e._(e._("Repay {0} {1} using {2} {3} as collateral",{0:a.toSignificant(6),1:a.currency.symbol,2:r.toSignificant(6),3:r.currency.symbol}))}),d.tx}else{let e,t;h&&v.QA.greaterThan(c.userBorrowPart,v.QA.BigInt(0))?(j.repayPart(u.O$.from(c.userBorrowPart.toString()),!p),e="Repay max"):null!==d&&void 0!==d&&d.greaterThan(v.xE)&&(j.repay(u.O$.from(d.quotient.toString()),!p),e="Repay"),m?(t=c.userCollateralShare,e="and remove max collateral"):null!==x&&void 0!==x&&x.greaterThan(v.xE)&&(t=(0,me.T)(c.collateral,x.quotient),e="and remove collateral"),t&&j.removeCollateral(u.O$.from(t.toString()),!g);const a=await j.cook();if(a.success)return i(a.tx,{summary:e}),a.tx}}),[t,i,o,s,e,a,c,n])},ve=()=>(0,o.jsxs)("div",{className:"flex flex-col gap-3 p-2 md:p-4 pt-4 rounded-[24px] bg-dark-800 shadow-md shadow-dark-1000",children:[(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-2 h-[42px] rounded-full",children:[(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"}),(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"}),(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"}),(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-2 h-[36px] rounded-full",children:[(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"}),(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"}),(0,o.jsx)("div",{className:"w-full h-full bg-dark-700 rounded-full animate-pulse"})]}),(0,o.jsxs)("div",{className:"flex flex-col justify-between bg-dark-900 rounded h-[114px] p-4 pt-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between h-9",children:[(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-5 h-5 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"})]}),(0,o.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-10 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-12 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-3 h-3 animate-pulse"})]})]}),(0,o.jsxs)("div",{className:"flex items-end justify-between",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-9 w-[120px] animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"})]})]}),(0,o.jsxs)("div",{className:"flex flex-col justify-between bg-dark-900 rounded h-[114px] p-4 pt-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between h-9",children:[(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-5 h-5 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"})]}),(0,o.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-10 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-12 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-3 h-3 animate-pulse"})]})]}),(0,o.jsxs)("div",{className:"flex items-end justify-between",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-9 w-[120px] animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-20 animate-pulse"})]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-2 p-4 border-2 border-dark-700 h-12 rounded",children:[(0,o.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-3 h-3 animate-pulse"}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full h-5 w-10 animate-pulse"})]}),(0,o.jsx)("div",{className:"bg-dark-700 rounded-full w-5 h-5 animate-pulse"})]}),(0,o.jsx)("div",{className:"rounded animate-pulse bg-dark-700 h-[52px]"})]}),ge=e=>{let{receiveToWallet:t,withdrawAmount:a,removeMax:s}=e;const{account:n}=(0,C.aQ)(),{i18n:i}=(0,r.mV)(),{market:c}=M(),{chainId:d}=(0,C.aQ)(),u=(0,S.C)(null!==n&&void 0!==n?n:void 0,(0,k.Bv)(c.asset.token),!1),{0:x,1:m}=(0,l.useState)(),{0:h,1:g}=(0,l.useState)(),p=(0,Z.rO)(),j=d?v.MO[d]:void 0,{0:w,1:b}=(0,l.useState)(!1),N=n?null!==a&&void 0!==a&&a.greaterThan(v.xE)?u?"":i._(i._("Loading balance")):i._(i._("Enter an amount")):i._(i._("Connect Wallet")),A=N||(null!==a&&void 0!==a&&a.greaterThan(v.xE)?i._(i._("Withdraw")):"");return(0,o.jsxs)(o.Fragment,{children:[h&&(0,o.jsx)(f.Z,{variant:"sm",className:"p-4 text-center border rounded border-yellow/40 text-yellow",children:i._(i._("Something went wrong during signing of the approval. This is expected for hardware wallets, such as Trezor and Ledger. Click 'Approve BentoBox' again for approving using the fallback method"))}),(0,o.jsx)(_.Z,{spendFromWallet:t,inputAmounts:[a],tokenApproveOn:null===p||void 0===p?void 0:p.address,masterContractAddress:j,withPermit:!0,permit:x,onPermit:m,onPermitError:()=>g(!0),children:e=>{let{approved:t,loading:a}=e;const r=!!N||!t||a;return(0,o.jsx)(y.ZP,{loading:a,color:"gradient",disabled:r,onClick:()=>b(!0),className:"rounded-2xl md:rounded",children:A})}}),(0,o.jsx)(pe,{open:w,onDismiss:()=>b(!1),receiveToWallet:t,withdrawAmount:a,removeMax:s,permit:x})]})},pe=e=>{let{withdrawAmount:t,receiveToWallet:a,open:s,onDismiss:n,permit:i,removeMax:d}=e;const{i18n:u}=(0,r.mV)(),{0:x,1:m}=(0,l.useState)(),{0:h,1:v}=(0,l.useState)(!1),g=be(),p=(0,l.useCallback)((async()=>{v(!0);try{const e=await g({withdrawAmount:t,receiveToWallet:a,permit:i,removeMax:d});null!==e&&void 0!==e&&e.hash&&m(e.hash)}finally{v(!1)}}),[g,i,a,d,t]);return(0,o.jsx)(R.S.Controlled,{isOpen:s,onDismiss:n,maxWidth:"md",afterLeave:()=>m(void 0),children:x?(0,o.jsx)(T.Z,{header:u._(u._("Success!")),subheader:u._(u._("Success! Withdraw Submitted")),txHash:x,onDismiss:n}):(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)(R.S.Header,{header:u._(u._("Confirm Withdraw")),onClose:n}),(0,o.jsx)(R.S.BorderedContent,{className:"flex flex-col gap-4 bg-dark-1000/40 !border-dark-700",children:(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)(f.Z,{variant:"xs",className:"text-secondary",children:u._(u._("Withdrawing"))}),(0,o.jsxs)("div",{className:"inline-flex gap-2",children:[(0,o.jsx)(O.X,{currency:null===t||void 0===t?void 0:t.currency,size:20}),(0,o.jsxs)("b",{children:[null===t||void 0===t?void 0:t.toSignificant(6)," ",null===t||void 0===t?void 0:t.currency.symbol]})]})]})}),(0,o.jsx)(J,{view:c.WITHDRAW,lentAmount:t}),(0,o.jsx)(y.ZP,{loading:h,color:"gradient",disabled:h,onClick:p,children:u._(u._("Confirm Withdraw"))})]})})};function fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(a),!0).forEach((function(t){(0,b.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const we=()=>{const{i18n:e}=(0,r.mV)(),{market:t}=M(),{0:a,1:s}=(0,l.useState)(),{0:n,1:i}=(0,l.useState)(!0),{0:d,1:u}=(0,l.useState)(!1),x=(0,k.Bv)(t.asset.token),m=(0,k.eo)(a,x),h=(0,l.useMemo)((()=>v.ih.fromRawAmount(t.asset.token,(0,v.LT)(t.maxAssetAvailable,t.currentUserAssetAmount))),[t.asset.token,t.currentUserAssetAmount,t.maxAssetAvailable]);return(0,o.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,o.jsx)(K,{setLentAmount:s}),(0,o.jsx)(D.Z,{error:!1,header:t=>(0,o.jsx)(D.Z.Header,je(je({},t),{},{label:e._(e._("Withdraw")),hideSearchModal:!0})),walletToggle:t=>(0,o.jsx)(D.Z.Switch,je(je({id:"switch-classic-withdraw-from-0}"},t),{},{label:e._(e._("Receive to")),onChange:()=>i((e=>!e))})),spendFromWallet:n,currency:x,value:null===m||void 0===m?void 0:m.toSignificant(6),onChange:e=>{s(e),u(!1)},balancePanel:e=>{let{onChange:t}=e;return(0,o.jsxs)(f.Z,{variant:"sm",className:"text-right text-secondary",onClick:()=>{t(null===h||void 0===h?void 0:h.toExact()),u(!0)},children:["Max: ",null===h||void 0===h?void 0:h.toSignificant(6)]})}}),(0,o.jsx)(J,{view:c.WITHDRAW,lentAmount:m}),(0,o.jsx)(ge,{withdrawAmount:m,receiveToWallet:n,removeMax:d})]})};var ye=a(46440);const be=()=>{const{i18n:e}=(0,r.mV)(),{market:t}=M(),{account:a,library:s,chainId:n}=(0,C.aQ)(),i=(0,q.h7)(),o=(0,Z.rO)(),c=n&&v.MO[n],d=(0,Z.Fe)();return(0,l.useCallback)((async r=>{let{withdrawAmount:l,receiveToWallet:x,permit:m,removeMax:h=!1}=r;if(!a||!s||!n||!c||!o||!l)return void console.error("Dependencies unavailable");const g=new U.Z(t,a,s,n);m&&g.approve({account:a,masterContract:c,v:m.v,r:m.r,s:m.s});let p=h?(0,k.LT)(t.userAssetFraction.toString(),t.maxAssetAvailableFraction.toString()):(0,k.To)({base:t.currentTotalAsset.base,elastic:v.QA.BigInt(t.currentAllAssets.toString())},u.O$.from(l.quotient.toString()));if(d&&x){const e=(0,k.uN)(t.asset.token.wrapped.address,ye.RB,s),a=await e.balanceOf(null===o||void 0===o?void 0:o.address);if(l.greaterThan(a.toString())){const r=(0,k.To)({base:t.currentTotalAsset.base,elastic:v.QA.BigInt(t.currentAllAssets.toString())},u.O$.from(a));g.removeAsset(r,!x),g.action(d.address,0,"0x252dba42000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000".concat(o.address.slice(2),"0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006466c6bb0b000000000000000000000000").concat(e.address.slice(2),"0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),!1,!1,0),p=r.sub(p)}}g.removeAsset(p,!x);const f=await g.cook();return f.success?(i(f.tx,{summary:e._(e._("Withdraw {0} {1}",{0:l.toSignificant(6),1:l.currency.symbol}))}),f.tx):void 0}),[a,i,o,n,e,s,t,c,d])},Ne=e=>{let{borrowAmount:t,collateralAmount:a,invert:r,trade:s,reduce:n}=e;const{market:i}=M(),l=v.ih.fromRawAmount((0,k.Bv)(i.collateral.token),i.userCollateralAmount),o=v.ih.fromRawAmount((0,k.Bv)(i.asset.token),i.currentUserBorrowAmount),c=(0,Z.oF)(i.collateral.token),d=(0,z.C)(H.tE);try{const e=a&&s?a[n?"subtract":"add"](s.minimumAmountOut(d)):a,i=e?l[n?"subtract":"add"](e):l,u=t?o[n?"subtract":"add"](t):o;if(u.equalTo(v.xE))return"None";const x=u&&i&&u.greaterThan(v.xE)?new v.tA({baseAmount:u,quoteAmount:i.multiply(L.AS)}):void 0,m=Number(null===x||void 0===x?void 0:x.invert().toSignificant(6));return m>Number(null===c||void 0===c?void 0:c.toSignificant(6))||Number(null===x||void 0===x?void 0:x.invert().toSignificant(6))<0?"Instant liquidation":m?r?"1 ".concat(null===u||void 0===u?void 0:u.currency.symbol," = ").concat(null===x||void 0===x?void 0:x.toSignificant(6)," ").concat(null===i||void 0===i?void 0:i.currency.symbol):"1 ".concat(null===i||void 0===i?void 0:i.currency.symbol," = ").concat(null===x||void 0===x?void 0:x.invert().toSignificant(6)," ").concat(null===u||void 0===u?void 0:u.currency.symbol):"None"}catch(u){return console.log(u),"Instant liquidation"}}},81889:function(e,t,a){a.d(t,{AS:function(){return s}});var r=a(31518);const s=new r.iA(75,100);new r.gG(50,1e4),new r.iA(95,100)},1420:function(e,t,a){a.d(t,{Pf:function(){return m},yz:function(){return u}});var r=a(59499),s=a(72457),n=a(3382),i=a(44554),l=(a(67294),a(85893));var o=function(){return(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxHeight:"75vh",paddingTop:"25px",overflow:"hidden"},children:(0,l.jsx)("div",{style:{maxWidth:"100%",height:"auto"},children:(0,l.jsx)("a",{href:"https://depot.steamexchange.io",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:(0,l.jsx)("image",{href:"https://github.com/divechan/brandkit/blob/main/depot%20ad.jpg?raw=true",style:{width:"100%"}})})})})},c=a(76138);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const u=e=>{let{children:t,className:a}=e;return(0,l.jsx)("div",{className:(0,i.AK)("flex flex-col gap-3 p-2 md:p-4 pt-4",a),style:{background:"rgba(12, 29, 49, 0.1)",borderRadius:"5px",boxShadow:"0px 0px 20px 5px #1f4a7d",border:"2px solid #1f4a7d"},children:t})},x=e=>{let{children:t,id:a}=e;return(0,l.jsx)(c.Z,{children:(0,l.jsxs)(s.Z,{id:a,className:"py-4 md:py-12 lg:py-[120px] px-2 mx-auto",maxWidth:"md",children:[(0,l.jsxs)("div",{style:{position:"relative"},children:[(0,l.jsx)("div",{className:"absolute top-0 left-0 w-full h-full",style:window.innerWidth>=769?{backgroundImage:"url(https://github.com/divechan/brandkit/blob/main/10.jpg?raw=true)",backgroundSize:"cover",opacity:.25,zIndex:0}:null,"aria-hidden":"true"}),(0,l.jsx)(n.Z,{children:t})]}),(0,l.jsx)(o,{})]})})},m=e=>t=>(0,l.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({id:e},t))}}]);