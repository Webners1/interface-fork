"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8682],{8682:function(t,e,r){r.d(e,{lZ:function(){return C},tT:function(){return D},Hj:function(){return T},LQ:function(){return S},q7:function(){return O}});var a=r(84243),s=r(19485),i=r(9279),o=r(31518),n=r(10552),l=r(56279),u=r(38239),c=r(44554),d=r(53389),A=r(62483),h=r(61647),g=r(94633),Q=r(2886),v=r(84329),m=r(12614),p=r(67294),x=r(59499),B=r(69807),f=r(70867);function E(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){(0,x.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}class I{static getAddress(t,e,r,a){return(0,f.f7)({collateral:t,asset:e,oracle:r,oracleData:a})}constructor(t){let{accrueInfo:e,collateral:r,asset:a,collateralPrice:s,assetPrice:i,oracle:o,totalCollateralShare:n,totalAsset:l,totalBorrow:u,exchangeRate:c,oracleExchangeRate:d,spotExchangeRate:A,userCollateralShare:h,userAssetFraction:g,userBorrowPart:Q}=t;(0,x.Z)(this,"address",void 0),(0,x.Z)(this,"accrueInfo",void 0),(0,x.Z)(this,"collateral",void 0),(0,x.Z)(this,"asset",void 0),(0,x.Z)(this,"collateralPrice",void 0),(0,x.Z)(this,"assetPrice",void 0),(0,x.Z)(this,"oracle",void 0),(0,x.Z)(this,"totalCollateralShare",void 0),(0,x.Z)(this,"totalAsset",void 0),(0,x.Z)(this,"totalBorrow",void 0),(0,x.Z)(this,"exchangeRate",void 0),(0,x.Z)(this,"oracleExchangeRate",void 0),(0,x.Z)(this,"spotExchangeRate",void 0),(0,x.Z)(this,"userCollateralShare",void 0),(0,x.Z)(this,"userAssetFraction",void 0),(0,x.Z)(this,"userBorrowPart",void 0),this.address=I.getAddress(r.token,a.token,o.address,o.data),this.accrueInfo=e,this.collateral=r,this.asset=a,this.collateralPrice=s,this.assetPrice=i,this.oracle=o,this.totalCollateralShare=n,this.totalAsset=l,this.totalBorrow=u,this.exchangeRate=c,this.oracleExchangeRate=d,this.spotExchangeRate=A,this.userCollateralShare=h,this.userAssetFraction=g,this.userBorrowPart=Q}get elapsedSeconds(){const t=o.QA.divide(o.QA.BigInt(Date.now()),o.QA.BigInt(1e3));return o.QA.subtract(t,this.accrueInfo.lastAccrued)}get interestPerYear(){return o.QA.multiply(this.accrueInfo.interestPerSecond,o.QA.BigInt(31536e3))}get currentInterestPerYear(){return(0,f.FO)(this,this.interestPerYear)}get totalCollateralAmount(){return(0,B.s)(this.collateral,this.totalCollateralShare)}get totalAssetAmount(){return(0,B.s)(this.asset,this.totalAsset.elastic)}get totalAssetAmountUSD(){var t;return null===(t=this.assetPrice)||void 0===t?void 0:t.quote(o.ih.fromRawAmount(this.asset.token,this.totalAssetAmount))}get currentBorrowAmount(){return(0,f.Mu)(this,this.totalBorrow.elastic,!0)}get currentBorrowAmountUSD(){var t;return null===(t=this.assetPrice)||void 0===t?void 0:t.quote(o.ih.fromRawAmount(this.asset.token,this.currentBorrowAmount))}get currentAllAssets(){return o.QA.add(this.totalAssetAmount,this.currentBorrowAmount)}get currentAllAssetsUSD(){var t;return null===(t=this.assetPrice)||void 0===t?void 0:t.quote(o.ih.fromRawAmount(this.asset.token,this.currentAllAssets))}get currentAllAssetShares(){return(0,B.T)(this.asset,this.currentAllAssets)}get currentTotalAsset(){return function(t){const e=o.QA.divide(o.QA.multiply(o.QA.multiply(t.totalBorrow.elastic,t.accrueInfo.interestPerSecond),o.QA.add(t.elapsedSeconds,o.QA.BigInt(3600))),o.QA.BigInt(1e18)),r=o.QA.divide(o.QA.multiply(e,f.rO),f.LY),a=o.QA.greaterThan(t.currentAllAssets,o.xE)?o.QA.divide(o.QA.multiply(r,t.totalAsset.base),t.currentAllAssets):o.xE;return{elastic:t.totalAsset.elastic,base:o.QA.add(t.totalAsset.base,a)}}(this)}get maxAssetAvailable(){return(0,o.LT)(o.QA.greaterThan(this.currentAllAssetShares,o.xE)?o.QA.divide(o.QA.multiply(this.totalAsset.elastic,this.currentAllAssets),this.currentAllAssetShares):o.xE,(0,B.s)(this.asset,(0,o.Nt)(this.currentTotalAsset,o.QA.subtract(this.totalAsset.base,o.QA.BigInt(1e3)),!1)))}get maxAssetAvailableFraction(){return o.QA.equal(this.currentAllAssets,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.maxAssetAvailable,this.currentTotalAsset.base),this.currentAllAssets)}get minimumExchangeRate(){return(0,o.LT)(this.exchangeRate,this.spotExchangeRate,this.oracleExchangeRate)}get maximumExchangeRate(){return(0,o.gW)(this.exchangeRate,this.spotExchangeRate,this.oracleExchangeRate)}get marketHealth(){return o.QA.equal(this.currentBorrowAmount,o.xE)||o.QA.equal(this.maximumExchangeRate,o.xE)?o.xE:o.QA.divide(o.QA.multiply(o.QA.divide(o.QA.multiply(this.totalCollateralAmount,o.QA.BigInt(1e18)),this.maximumExchangeRate),o.QA.BigInt(1e18)),this.currentBorrowAmount)}get utilization(){return o.QA.equal(this.currentAllAssets,o.xE)?o.xE:o.QA.divide(o.QA.multiply(o.QA.BigInt(1e18),this.currentBorrowAmount),this.currentAllAssets)}get supplyAPR(){return(0,f.Ym)(o.QA.divide(o.QA.multiply(this.interestPerYear,this.utilization),o.QA.BigInt(1e18)))}get currentSupplyAPR(){return(0,f.Ym)(o.QA.divide(o.QA.multiply(this.currentInterestPerYear,this.utilization),o.QA.BigInt(1e18)))}get userCollateralAmount(){return(0,B.s)(this.collateral,this.userCollateralShare)}get currentUserAssetAmount(){return o.QA.equal(this.totalAsset.base,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.userAssetFraction,this.currentAllAssets),this.totalAsset.base)}get currentUserBorrowAmount(){return o.QA.equal(this.totalBorrow.base,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.userBorrowPart,this.currentBorrowAmount),this.totalBorrow.base)}get currentUserLentAmount(){return o.QA.equal(this.totalAsset.base,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.userAssetFraction,this.currentBorrowAmount),this.totalAsset.base)}get feesEarned(){return o.QA.equal(this.totalAsset.base,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.accrueInfo.feesEarnedFraction,this.currentAllAssets),this.totalAsset.base)}get maxBorrowable(){const t={oracle:o.QA.greaterThan(this.oracleExchangeRate,o.xE)?o.QA.divide(o.QA.multiply(this.userCollateralAmount,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),this.oracleExchangeRate):o.xE,spot:o.QA.greaterThan(this.spotExchangeRate,o.xE)?o.QA.divide(o.QA.multiply(this.userCollateralAmount,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),this.spotExchangeRate):o.xE,stored:o.QA.greaterThan(this.exchangeRate,o.xE)?o.QA.divide(o.QA.multiply(this.userCollateralAmount,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),this.exchangeRate):o.xE},e=(0,o.LT)(...Object.values(t)),r=o.QA.subtract(o.QA.divide(o.QA.multiply(e,o.QA.BigInt(95)),o.QA.BigInt(100)),this.currentUserBorrowAmount),a=(0,o.LT)(r,this.maxAssetAvailable);return b(b({},t),{},{minimum:e,safe:r,possible:a})}simulatedMaxBorrowable(t,e){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a={oracle:o.QA.greaterThan(this.oracleExchangeRate,o.xE)?o.QA.divide(o.QA.multiply(e,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),this.oracleExchangeRate):o.xE,spot:o.QA.greaterThan(this.spotExchangeRate,o.xE)?o.QA.divide(o.QA.multiply(e,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),this.spotExchangeRate):o.xE,stored:o.QA.greaterThan(this.exchangeRate,o.xE)?o.QA.divide(o.QA.multiply(e,o.QA.multiply(o.QA.BigInt(1e16),o.QA.BigInt(75))),r?this.oracleExchangeRate:this.exchangeRate):o.xE},s=(0,o.LT)(...Object.values(a)),i=o.QA.subtract(o.QA.divide(o.QA.multiply(s,o.QA.BigInt(95)),o.QA.BigInt(100)),this.currentUserBorrowAmount),n=(0,o.LT)(i,this.maxAssetAvailable);return b(b({},a),{},{minimum:s,safe:i,possible:n})}get health(){return o.QA.equal(this.maxBorrowable.minimum,o.xE)?o.xE:o.QA.divide(o.QA.multiply(this.currentUserBorrowAmount,o.QA.BigInt(1e18)),this.maxBorrowable.minimum)}simulatedHealth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.QA.BigInt(0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.QA.BigInt(0);const{minimum:r}=this.simulatedMaxBorrowable(t,e);return o.QA.equal(r,o.xE)?o.xE:o.QA.divide(o.QA.multiply(t,o.QA.BigInt(1e18)),r)}}var w=I;const y=["0xC6d54D2f624bc83815b49d9c2203b1330B841cA0","0xC011a73ee8576Fb46F5E1c5751cA3B9Fe0af2a6F","0x8Ab7404063Ec4DBcfd4598215992DC3F8EC853d7","0x4fE83213D56308330EC302a8BD641f1d0113A4Cc","0xADE00C28244d5CE17D72E40330B1c318cD12B7c3"],R=["0x8f2CC3376078568a04eBC600ae5F0a036DBfd812","0x8f7C7181Ed1a2BA41cfC3f5d064eF91b67daef66","0x6b7D436583e5fE0874B7310b74D29A13af816860"],S=t=>T(t,O()).filter((t=>o.QA.greaterThan(t.userAssetFraction,o.xE))),C=t=>T(t,O()).filter((t=>o.QA.greaterThan(t.userCollateralShare,o.xE)||o.QA.greaterThan(t.userBorrowPart,o.xE)));function P(){const{chainId:t}=(0,m.aQ)(),e=(0,A.rU)();return(0,p.useMemo)((()=>Object.values(e).reduce(((e,r)=>{var a;return t&&null!==l.k&&void 0!==l.k&&l.k[t]&&null!==(a=Object.values(null===l.k||void 0===l.k?void 0:l.k[t]))&&void 0!==a&&a.some((t=>r.address===t.from||r.address===t.to))&&(e[r.address]=r),e}),{})),[e,t])}function O(){const t=(0,d.rO)(),{chainId:e}=(0,m.aQ)(),r=(0,p.useMemo)((()=>Boolean(e&&e!==o.a_.BSC&&e!==o.a_.MATIC&&e!==o.a_.ARBITRUM&&e!==o.a_.AVALANCHE)),[e]),s=P(),{data:i}=(0,m.Tp)({chainId:e,contract:t,event:e&&t&&t.filters.LogDeploy(o.MO[e]),shouldFetch:Boolean(e&&r&&(0,c.vR)(u.L.KASHI,e))}),n=(0,v.HD)({chainId:e,shouldFetch:!r});return(0,p.useMemo)((()=>{var t;return null===(t=r?null===i||void 0===i?void 0:i.map((t=>({address:t.args.cloneAddress,data:t.args.data}))):n)||void 0===t?void 0:t.reduce(((t,r)=>{try{const[i,o,n,l]=a.$.decode(["address","address","address","bytes"],r.data);return y.includes(i)||y.includes(o)||R.includes(n)||!(0,c.nm)(e,s[i],s[o],l)?t:[...t,r.address]}catch(i){return t}}),[])}),[e,n,i,s,r])}function T(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const{chainId:r}=(0,m.aQ)(),a=(0,d.HW)(),s=P(),l=(0,p.useMemo)((()=>[t||i.d,e]),[t,e]),{result:u,valid:A,loading:v,syncing:x,error:B}=(0,Q.Wk)(a,"pollKashiPairs",l,{gasRequired:2e7});B&&(console.log(null===a||void 0===a?void 0:a.interface.encodeFunctionData("pollKashiPairs",["0xfcf383459e08ccb1679f32ae7f22eb0afe974a4c",e])),console.log("BoringHelper failed: network: ".concat(r?n.z[r]:"undef",", boringhelper: ").concat(null===a||void 0===a?void 0:a.address,", calldata in console")));const{rebases:f}=(0,h.Z)((0,p.useMemo)((()=>Object.values(s)),[s])),E=(0,g.SA)(Object.values(s));return(0,p.useMemo)((()=>r&&u&&f&&E?null===u||void 0===u?void 0:u[0].reduce(((t,e)=>{var a,s;return!(y.includes(e.collateral)||y.includes(e.asset)||R.includes(e.oracle))&&f[e.collateral]&&null!==(a=f[e.collateral])&&void 0!==a&&a.token&&f[e.asset]&&null!==(s=f[e.asset])&&void 0!==s&&s.token?(t.push(new w({accrueInfo:{feesEarnedFraction:o.QA.BigInt(e.accrueInfo.feesEarnedFraction.toString()),lastAccrued:o.QA.BigInt(e.accrueInfo.lastAccrued),interestPerSecond:o.QA.BigInt(e.accrueInfo.interestPerSecond.toString())},collateral:f[e.collateral],asset:f[e.asset],collateralPrice:E[e.collateral],assetPrice:E[e.asset],oracle:(0,c.uw)(r,e.oracle,e.oracleData),totalCollateralShare:o.QA.BigInt(e.totalCollateralShare.toString()),totalAsset:{elastic:o.QA.BigInt(e.totalAsset.elastic.toString()),base:o.QA.BigInt(e.totalAsset.base.toString())},totalBorrow:{elastic:o.QA.BigInt(e.totalBorrow.elastic.toString()),base:o.QA.BigInt(e.totalBorrow.base.toString())},exchangeRate:o.QA.BigInt(e.currentExchangeRate.toString()),oracleExchangeRate:o.QA.BigInt(e.oracleExchangeRate.toString()),spotExchangeRate:o.QA.BigInt(e.spotExchangeRate.toString()),userCollateralShare:o.QA.BigInt(e.userCollateralShare.toString()),userAssetFraction:o.QA.BigInt(e.userAssetFraction.toString()),userBorrowPart:o.QA.BigInt(e.userBorrowPart.toString())})),t):t}),[]):[]),[r,E,f,u])}function D(t,e){return T(t,[(0,s.getAddress)(e)])[0]}},94633:function(t,e,r){r.d(e,{Gj:function(){return c},SA:function(){return n},ZP:function(){return l},or:function(){return u}});var a=r(31518),s=r(84329),i=r(12614),o=r(67294);function n(t){const{chainId:e}=(0,i.aQ)(),r=e&&a.qY[e]?a.ih.fromRawAmount(a.qY[e],0).currency:void 0,{data:n}=(0,s.k$)({chainId:e}),l=(0,s.rU)({chainId:e,variables:{where:{id_in:null===t||void 0===t?void 0:t.map((t=>t.wrapped.address.toLowerCase()))}},shouldFetch:t&&(null===t||void 0===t?void 0:t.length)>0}),{data:u}=(0,s.EO)({chainId:e,variables:{where:{id_in:null===t||void 0===t?void 0:t.map((t=>t.wrapped.address.toLowerCase()))}},shouldFetch:t&&(null===t||void 0===t?void 0:t.length)>0});return(0,o.useMemo)((()=>{if(!t||0===t.length||!r||!l&&!u)return;const e={};return t.map((t=>{let s;const i=null===l||void 0===l?void 0:l.find((e=>e.id===t.wrapped.address.toLowerCase())),o=null===u||void 0===u?void 0:u.find((e=>e.id===t.wrapped.address.toLowerCase()));if(null!==t&&void 0!==t&&t.wrapped.equals(r))e[t.wrapped.address]=new a.tA(r,r,"1","1");else if(i&&o?s=i.liquidity>o.kpi.liquidity?n*i.derivedETH:o.price.derivedUSD:n&&i?s=n*i.derivedETH:o&&(s=o.price.derivedUSD),void 0!==s&&0!==s){var c,d,A;const i=10**(null!==(c=null===(d=String(s).split("."))||void 0===d||null===(A=d[1])||void 0===A?void 0:A.length)&&void 0!==c?c:0),o=Math.floor(s*i);try{e[t.wrapped.address]=new a.tA(t,r,i*10**t.decimals/10**r.decimals,o)}catch{}}})),e}),[t,r,l,u,n])}function l(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=n(t?[t]:void 0,e);return r?Object.values(r)[0]:void 0}function u(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=l(null===t||void 0===t?void 0:t.currency,e);return(0,o.useMemo)((()=>{if(!r||!t)return null;try{return r.quote(t)}catch(e){return null}}),[t,r])}function c(t){const e=l(null===t||void 0===t?void 0:t.currency);return(0,o.useMemo)((()=>{if(!e||!t)return{value:void 0,loading:!1};try{return{value:e.quote(t),loading:!1}}catch(r){return{value:void 0,loading:!1}}}),[t,e])}}}]);